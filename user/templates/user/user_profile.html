{% extends 'event/base.html' %}
{% load static %}
{% block title %}Profile{% endblock %}
{% block profile_active %}active{% endblock %}

{% block body %}
<div class="container event-main-content" style="max-width:1200px;">
  <div class="row">
    <!-- Left Column: Profile Card -->
    <div class="col-md-4 col-sm-12">
      <div class="card" style="box-shadow:0 2px 8px rgba(0,0,0,0.08); border-radius:12px; padding:32px 24px; background:#fff; margin-bottom:32px;">
        <div class="text-center">
          {% if profile.image %}
            <img src="{{ profile.image.url }}" class="img-responsive" alt="Profile Picture" style="max-width:220px; border-radius:10px; margin-bottom:16px;">
          {% else %}
            <img src="{% static 'event/images/default_profile.png' %}" class="img-responsive" alt="Default Profile" style="max-width:220px; border-radius:10px; margin-bottom:16px;">
          {% endif %}
          <h2 style="font-size:2.2rem; font-weight:700; margin-bottom:8px;">{{ user.first_name }} {{ user.last_name }}</h2>
        </div>
  <form action="{% url 'user:update_profile' %}" method="get" style="margin-top:24px;">
          {% csrf_token %}
          <button type="submit" class="btn btn-info btn-block" style="font-size:1.1rem; margin-bottom:10px;">
            <span class="glyphicon glyphicon-edit"></span> Update Profile Details
          </button>
        </form>
  <a href="{% url 'user:change_password' %}" class="btn btn-warning btn-block" style="font-size:1.1rem; margin-bottom:10px;">
          <span class="glyphicon glyphicon-lock"></span> Change Password
        </a>
  <a href="{% url 'user:change_wallet_pin' %}" class="btn btn-danger btn-block" style="font-size:1.1rem;">
          <span class="glyphicon glyphicon-credit-card"></span> Change Wallet Pin
        </a>
      </div>
    </div>

    <!-- Right Column: Profile Info & Tickets -->
    <div class="col-md-8 col-sm-12">
      <div class="card" style="box-shadow:0 2px 8px rgba(0,0,0,0.08); border-radius:12px; background:#f8f9fa; margin-bottom:32px; padding:32px 24px;">
        <div style="border-bottom:1px solid #e9ecef; margin-bottom:24px;">
          <h4 style="font-size:1.3rem; font-weight:600; color:#1976d2; margin-bottom:12px;">Hi, {{ user.first_name|lower }}</h4>
        </div>
        <div style="font-size:1.2rem; font-weight:500; color:#222; margin-bottom:24px;">
          <div><strong>Bio:</strong> {{ profile.bio }}</div>
          <div><strong>Age:</strong> {{ profile.age }}</div>
          <div><strong>DoB:</strong> {{ profile.birth_date|date:'M. d, Y' }}</div>
          <div><strong>Address:</strong> {{ profile.location }}</div>
          <div><strong>Wallet Balance:</strong> <span style="color:#28a745; font-weight:700;">{{ profile.wallet_balance }}</span></div>
        </div>
      </div>
      <div class="card" style="box-shadow:0 2px 8px rgba(0,0,0,0.08); border-radius:12px; background:#f8f9fa; padding:32px 24px;">
        <div style="border-bottom:1px solid #e9ecef; margin-bottom:24px;">
          <h4 style="font-size:1.3rem; font-weight:600; color:#1976d2; margin-bottom:12px;">{{ user.first_name }}'s Tickets & Invitations</h4>
        </div>
        {% if tickets %}
          {% for ticket in tickets %}
            <div style="margin-bottom:18px; padding-bottom:12px; border-bottom:1px solid #e9ecef;">
              <div><strong>Event:</strong> {{ ticket.event.name }}</div>
              <div><strong>Type:</strong> {% if ticket.flag %}Ticket{% else %}Invitation{% endif %}</div>
            </div>
          {% endfor %}
        {% else %}
          <div>No tickets or invitations found.</div>
        {% endif %}
      </div>
    </div>
  </div>
</div>
        
{% endblock %}
